<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>[node]  세션 Session | Huusz&#39;s Log</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="session" />
    
    <meta name="description" content="세션 Session세션의 의미사전적 의미1) (특정한 활동을 위한) 시간2) (의회 등의) 회기; (법정의) 개정 (기간) 실질적 의미1) 시작 조건과 종료 조건이 있는 시간, 또는 회기2) 정보 교환이 지속되는 시간, 또는 회기 세션의 예HTTP session: 요청 - 응답 로그인 세션: 로그인 - 로그아웃 Google Analytics 세션:페이지">
<meta name="keywords" content="session">
<meta property="og:type" content="article">
<meta property="og:title" content="[node]  세션 Session">
<meta property="og:url" content="http://huusz.github.io/2017/Nodejs/nodejs/09.session/index.html">
<meta property="og:site_name" content="Huusz&#39;s Log">
<meta property="og:description" content="세션 Session세션의 의미사전적 의미1) (특정한 활동을 위한) 시간2) (의회 등의) 회기; (법정의) 개정 (기간) 실질적 의미1) 시작 조건과 종료 조건이 있는 시간, 또는 회기2) 정보 교환이 지속되는 시간, 또는 회기 세션의 예HTTP session: 요청 - 응답 로그인 세션: 로그인 - 로그아웃 Google Analytics 세션:페이지">
<meta property="og:locale" content="ko">
<meta property="og:image" content="http://allvectorlogo.com/img/2016/05/node-js-logo.png">
<meta property="og:updated_time" content="2017-09-21T06:22:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[node]  세션 Session">
<meta name="twitter:description" content="세션 Session세션의 의미사전적 의미1) (특정한 활동을 위한) 시간2) (의회 등의) 회기; (법정의) 개정 (기간) 실질적 의미1) 시작 조건과 종료 조건이 있는 시간, 또는 회기2) 정보 교환이 지속되는 시간, 또는 회기 세션의 예HTTP session: 요청 - 응답 로그인 세션: 로그인 - 로그아웃 Google Analytics 세션:페이지">
<meta name="twitter:image" content="http://allvectorlogo.com/img/2016/05/node-js-logo.png">
    

    
        <link rel="alternate" href="https://huusz.github.io/feed.xml" title="Huusz&#39;s Log" type="application/atom+xml" />
    

    
        <link rel="icon" href="/css/images/favi.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="/libs/source-code-pro/styles.css"> -->

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-104157265-1', 'auto');
ga('send', 'pageview');

</script>
    
    


    
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Fira+Mono" rel="stylesheet">
    <link href="https://spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css" rel="stylesheet" type="text/css">
    <link href="https://spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-jp.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Cousine" rel="stylesheet">
</head>
<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a class="logo" href="https://huusz.github.io">
                        <img src="/css/images/header-logo.png" alt="Huusz Log"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Git/">Git</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Javascript/">Javascript</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Log/">Log</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Nodejs/">Nodejs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/React/">React</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Sass/">Sass</a></li></ul>
                                    
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'post',
            PAGES: 'Pages',
            CATEGORIES: 'categories',
            TAGS: 'tag',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Nodejs/">Nodejs</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-nodejs/09.session" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        [node]  세션 Session
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2017/Nodejs/nodejs/09.session/" class="article-date">
            <time datetime="2017-09-09T09:16:41.000Z" itemprop="datePublished">2017-09-09</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/session/">session</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><img src="http://allvectorlogo.com/img/2016/05/node-js-logo.png" alt=""></p>
<h1 id="세션-Session"><a href="#세션-Session" class="headerlink" title="세션 Session"></a>세션 Session</h1><h3 id="세션의-의미"><a href="#세션의-의미" class="headerlink" title="세션의 의미"></a>세션의 의미</h3><p><strong>사전적 의미</strong><br>1) (특정한 활동을 위한) 시간<br>2) (의회 등의) 회기; (법정의) 개정 (기간)</p>
<p><strong>실질적 의미</strong><br>1) 시작 조건과 종료 조건이 있는 시간, 또는 회기<br>2) 정보 교환이 지속되는 시간, 또는 회기</p>
<h3 id="세션의-예"><a href="#세션의-예" class="headerlink" title="세션의 예"></a>세션의 예</h3><p><strong>HTTP session</strong>: 요청 - 응답</p>
<p><strong>로그인 세션</strong>: 로그인 - 로그아웃</p>
<p><strong>Google Analytics 세션</strong>:<br>페이지 접속 - 30분간 접속이 없으면 종료로 간주 (커스터마이징 가능)  </p>
<h2 id="웹-서비스를-위한-세션의-구현"><a href="#웹-서비스를-위한-세션의-구현" class="headerlink" title="웹 서비스를 위한 세션의 구현"></a>웹 서비스를 위한 세션의 구현</h2><ol>
<li>세션이 시작되면(ex. 로그인하면), 세션이 시작되었다는 사실을 쿠키에 저장</li>
<li>세션에 대한 정보를 여러 요청에 걸쳐서 지속시키기 위해, 정보를 어딘가에 저장</li>
<li>세션이 만료되면(ex. 로그아웃하면), 세션이 만료되었다는 사실을 쿠키에 반영  </li>
</ol>
<p><sub> * 위 방식은 널리 사용되는 방식일 뿐, 반드시 위와 같이 구현해야 하는 것은 아니다.</sub></p>
<hr>
<p>만약, 브라우저가 갑자기 꺼지면 쿠키는 어떻게 되는가?  </p>
<p><strong>세션쿠키</strong>라는 것이 있다. 브라우저가 꺼지면 쿠키가 삭제되는 옵션이다. 이 옵션이 정의되어있다면 브라우저가 꺼지는 순간 쿠키가 삭제된다.하지만 지속시간이 긴 쿠키라면(직접 정의할 수 있다.) 브라우저를 껐다가 켜도 쿠키가 지속된다. </p>
<hr>
<h2 id="세션-스토어"><a href="#세션-스토어" class="headerlink" title="세션 스토어"></a>세션 스토어</h2><p>세션에 대한 정보를 저장하는 어딘가</p>
<ul>
<li>쿠키</li>
<li>데이터베이스</li>
<li>파일</li>
<li>기타 정보를 저장할 수 있는 곳 어디든</li>
</ul>
<h3 id="세션-스토어의-선택"><a href="#세션-스토어의-선택" class="headerlink" title="세션 스토어의 선택"></a>세션 스토어의 선택</h3><p>서비스의 요구사항에 맞춰서 적절한 저장소를 선택하면 된다.</p>
<ul>
<li><p>쿠키: 정보의 형태가 간단하고 자주 바뀔 일이 없다면</p>
</li>
<li><p>데이터베이스: 저장해야 할 정보의 양이 많다면</p>
</li>
<li><p>메모리 기반 저장소: 정보가 굉장히 자주 변경된다면</p>
</li>
</ul>
<h2 id="세션-세션-스토어"><a href="#세션-세션-스토어" class="headerlink" title="세션? 세션 스토어?"></a>세션? 세션 스토어?</h2><p>‘세션’과 ‘세션 스토어’는 혼용되는 경우가 많지만 엄연히 다른 말이다.</p>
<p>‘세션에 정보를 저장한다’는 말은 ‘세션 스토어에 정보를 저장한다’는 말과 같은 의미이다.   </p>
<h2 id="Express-Session"><a href="#Express-Session" class="headerlink" title="Express + Session"></a>Express + Session</h2><p><strong>cookie-session</strong></p>
<p>  쿠키에 모든 정보를 저장하는 세션 스토어. 첫 방문시 무조건 세션 시작.</p>
<p><strong>express-session</strong></p>
<p>  쿠키에는 세션 식별자만 저장하고 실제 정보의 저장은 외부 저장소(데이터베이스 등)를 이용하는 세션 스토어. 외부 저장소에 대한 별도의 설정 필요</p>
<h2 id="익스프레스-세션-예제"><a href="#익스프레스-세션-예제" class="headerlink" title="익스프레스 세션 예제"></a>익스프레스 세션 예제</h2><p><a href="https://glitch.com/edit/#!/laser-teal?path=README.md:1:0" target="_blank" rel="external">link</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// server.js</span></div><div class="line"></div><div class="line"><span class="comment">// cookie-session 설정</span></div><div class="line"><span class="comment">// name: 쿠키 이름으로 사용할 문자열</span></div><div class="line"><span class="comment">// secret: 세션 정보를 서명할 때 사용할 키</span></div><div class="line"><span class="comment">// secret은 비밀 정보. 공개되어서는 안 된다.</span></div><div class="line">app.use(cookieSession(&#123;</div><div class="line">  name: <span class="string">'session'</span>,</div><div class="line">  secret: process.env.SECRET</div><div class="line">&#125;))</div><div class="line"></div><div class="line"><span class="comment">// req.session.count를 처리하는 미들웨어</span></div><div class="line"><span class="keyword">const</span> countMiddleware = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="string">'count'</span> <span class="keyword">in</span> req.session) &#123;</div><div class="line">    <span class="comment">// count 속성이 있으면 1으.</span></div><div class="line">    req.session.count += <span class="number">1</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// count 속성이 없으면 처음 방문한 것이므로 1로 설정한다.</span></div><div class="line">    req.session.count = <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">  next()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 첫 방문 후, 쿠키 관련 헤더가 요청과 응답에 잘 포함되는지 살펴보고,</span></div><div class="line"><span class="comment">// 실제로 쿠키가 어떻게 저장되어있는지 살펴보세요.</span></div><div class="line">app.get(<span class="string">'/'</span>, countMiddleware, (req, res) =&gt; &#123;</div><div class="line">  res.render(<span class="string">'index.ejs'</span>, &#123;<span class="attr">count</span>: req.session.count&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(<span class="string">'/reset-count'</span>, (req, res) =&gt; &#123;</div><div class="line">  <span class="keyword">delete</span> req.session.count</div><div class="line">  res.redirect(<span class="string">'/'</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'listening...'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index. ejs</span></div><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;</div><div class="line">  &lt;<span class="regexp">/head&gt;</span></div><div class="line"><span class="regexp">  &lt;body&gt;</span></div><div class="line"><span class="regexp">    &lt;div&gt;</span></div><div class="line"><span class="regexp">      &lt;%= count %&gt;번 째 방문하셨습니다.</span></div><div class="line"><span class="regexp">    &lt;/</span>div&gt;</div><div class="line">    &lt;form action=<span class="string">"/reset-count"</span> method=<span class="string">"post"</span>&gt;</div><div class="line">      &lt;button type=<span class="string">"submit"</span>&gt;</div><div class="line">        초기화</div><div class="line">      &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>form&gt;</div><div class="line">  &lt;<span class="regexp">/body&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>html&gt;</div></pre></td></tr></table></figure>
<h2 id="인증-인가-예제"><a href="#인증-인가-예제" class="headerlink" title="인증/인가 예제"></a>인증/인가 예제</h2><p><a href="https://glitch.com/edit/#!/brave-picture?path=README.md:1:0" target="_blank" rel="external">link</a></p>
<p><strong>인증(Authentication)과 인가(Authorization)</strong></p>
<p>인증(Authentication)은 클라이언트가 누구인지를 확인하는 과정이다. 지금은 ‘인증과 로그인은 같은 말’이라고 생각하셔도 무방하다.</p>
<p>인가(=허가)는 클라이언트가 하려고 하는 작업이 해당 클라이언트에게 허가된 작업인지를 확인하는 과정이다. ‘권한 설정’이라고 생각하셔도 무방하다. 예를 들어 다음 카페나 네이버 클럽에서는 관리자만이 게시판을 만들거나 없앨 수 있도록 인가된다.</p>
<p><br></p>
<p><strong>인증 구현 전략</strong></p>
<p>인증은 여러가지 방식으로 구현될 수 있으며, 여기에서는 우리가 쓰고 있는 cookie-session 의 기능에 맞추어서 구현해보도록 한다.</p>
<p>cookie-session이 제공하는 미들웨어는 첫 방문시 바로 세션을 시작하고 (이를 guest session이라 부릅니다) 쿠키에 빈 세션 정보(빈 객체)를 저장한다. 그래서 첫 방문자에 대해서도 session 객체를 바로 쓸 수 있다.</p>
<p>아래와 같은 규칙으로 인증을 구현해보도록 한다.</p>
<ol>
<li><p><code>req.session.username === undefined</code>이면 로그인된 사용자가 없는 것으로 간주한다.</p>
</li>
<li><p>사용자가 로그인 폼을 전송하면 accounts 배열에 저장된 계정 정보 중에 일치하는 것이 있는지 확인하고, 있다면 <code>req.session.username</code>에 해당 사용자 이름을 저장한다. 만약 일치하는 계정이 없으면 <code>400 Bad Request</code> 응답을 보낸다.</p>
</li>
<li><p><code>req.session.username</code>에 저장된 값이 있다면 해당 사용자로 로그인이 되어 있다고 간주한다.</p>
</li>
<li><p>로그아웃을 하기 위해 <code>req.session = null</code>와 같이 대입해서 세션을 초기화한다.</p>
</li>
</ol>
<p>(인증이 된 뒤에는 <code>req.user</code>와 <code>res.locals.user</code>에 계정 객체를 주입해서 라우트 핸들러와 템플릿에서 편하게 접근할 수 있도록 미리 코드를 짜 두었다.)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sever.js - account</span></div><div class="line"><span class="keyword">const</span> accounts = [</div><div class="line">  &#123;</div><div class="line">    username: <span class="string">'seungha'</span>,</div><div class="line">    password: <span class="string">'kim'</span>,</div><div class="line">    name: <span class="string">'김승하'</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    username: <span class="string">'fast'</span>,</div><div class="line">    password: <span class="string">'campus'</span>,</div><div class="line">    name: <span class="string">'패스트캠퍼스'</span>,</div><div class="line">    admin: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//server.js - login</span></div><div class="line">app.post(<span class="string">'/login'</span>, urlencodedMiddleware, (req, res) =&gt; &#123;</div><div class="line">  </div><div class="line">  <span class="comment">// 인증 과정을 작성해주세요.</span></div><div class="line">  <span class="keyword">if</span>(accounts.find( <span class="function"><span class="params">acc</span> =&gt;</span> acc.username === req.body.username &amp;&amp; acc.password === req.body.password))&#123;</div><div class="line">    req.session.username = req.body.username;</div><div class="line">    </div><div class="line">    res.redirect(<span class="string">'/'</span>);</div><div class="line">    </div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    res.status(<span class="number">404</span>);</div><div class="line">    res.send(<span class="string">'404 Not Found'</span>);</div><div class="line">  &#125;</div><div class="line">  res.redirect(<span class="string">'/'</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//server.js - logout</span></div><div class="line">app.post(<span class="string">'/logout'</span>, urlencodedMiddleware, (req, res) =&gt; &#123;</div><div class="line">  <span class="comment">// 세션 초기화</span></div><div class="line">  req.session = <span class="literal">null</span></div><div class="line">  res.redirect(<span class="string">'/'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p><br></p>
<p><strong>인가 구현 전략</strong></p>
<p>관리자만이 비밀 정보(/secret)에 접근할 수 있도록 한다. 사용자가 관리자인지 아닌지의 여부는 계정 객체의 admin 속성에 저장되어 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// server.js - admin</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onlyAdminMiddleware</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">  <span class="comment">// `/secret`에 접속했을 때 이 미들웨어가 작동합니다.</span></div><div class="line">  <span class="keyword">const</span> user = req.session.username;</div><div class="line">  <span class="keyword">if</span>(accounts.find( <span class="function"><span class="params">acc</span> =&gt;</span> acc.username === user &amp;&amp; acc.admin))&#123;</div><div class="line">    <span class="comment">// admin이면 통과!</span></div><div class="line">    next();</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    res.status(<span class="number">403</span>);</div><div class="line">    res.send(<span class="string">'403 Forbidden'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">app.get(<span class="string">'/secret'</span>, onlyAdminMiddleware, (req, res) =&gt; &#123;</div><div class="line">  res.send(<span class="string">'It is my secret'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>

        </div>
        <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon fa"></i></a>
    <div class="sidebar-top">
        <p>follow</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="https://www.facebook.com/hyeseung.lee.93" target="_blank">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/huusz" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="https://huusz.github.io/feed.xml" target="_blank">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2017/Nodejs/nodejs/00.POST VS PUT/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">newer</strong>
        <p class="article-nav-title">
        
            [node]  REST API: POST VS PUT
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2017/Nodejs/nodejs/08.cookie/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">older</strong>
        <p class="article-nav-title">[node] 쿠키 Cookie</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap">
        <h3 class="widget-title">recents</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/Log/Log/01.dada-log-01/" class="thumbnail">
    
    
        <span style="background-image:url(https://lh3.googleusercontent.com/-3h309I9VX1w/WdIAFCTzKhI/AAAAAAAAAbU/9HlUNs0Qi6QkdvWJE7MmITLOZajR4jwIwCL0BGAs/w530-d-h305-n-rw/origin.png)" alt="[삽질Log] semantic-ui-react와 css-module을 같이 사용할 수 없을까?" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Log/">Log</a></p>
                            <p class="item-title"><a href="/2017/Log/Log/01.dada-log-01/" class="title">[삽질Log] semantic-ui-react와 css-module을 같이 사용할 수 없을까?</a></p>
                            <p class="item-date"><time datetime="2017-10-02T07:31:11.000Z" itemprop="datePublished">2017-10-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/React/React/01.basic/" class="thumbnail">
    
    
        <span style="background-image:url(https://cdn-images-1.medium.com/max/2000/1*HSisLuifMO6KbLfPOKtLow.jpeg)" alt="[React] 리액트 입문하기" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/React/">React</a></p>
                            <p class="item-title"><a href="/2017/React/React/01.basic/" class="title">[React] 리액트 입문하기</a></p>
                            <p class="item-date"><time datetime="2017-09-20T11:32:01.000Z" itemprop="datePublished">2017-09-20</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/Nodejs/nodejs/00.POST VS PUT/" class="thumbnail">
    
    
        <span style="background-image:url(http://allvectorlogo.com/img/2016/05/node-js-logo.png)" alt="[node]  REST API: POST VS PUT" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Nodejs/">Nodejs</a></p>
                            <p class="item-title"><a href="/2017/Nodejs/nodejs/00.POST VS PUT/" class="title">[node]  REST API: POST VS PUT</a></p>
                            <p class="item-date"><time datetime="2017-09-09T09:42:28.000Z" itemprop="datePublished">2017-09-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/Nodejs/nodejs/09.session/" class="thumbnail">
    
    
        <span style="background-image:url(http://allvectorlogo.com/img/2016/05/node-js-logo.png)" alt="[node]  세션 Session" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Nodejs/">Nodejs</a></p>
                            <p class="item-title"><a href="/2017/Nodejs/nodejs/09.session/" class="title">[node]  세션 Session</a></p>
                            <p class="item-date"><time datetime="2017-09-09T09:16:41.000Z" itemprop="datePublished">2017-09-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/Nodejs/nodejs/08.cookie/" class="thumbnail">
    
    
        <span style="background-image:url(http://allvectorlogo.com/img/2016/05/node-js-logo.png)" alt="[node] 쿠키 Cookie" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Nodejs/">Nodejs</a></p>
                            <p class="item-title"><a href="/2017/Nodejs/nodejs/08.cookie/" class="title">[node] 쿠키 Cookie</a></p>
                            <p class="item-date"><time datetime="2017-09-09T09:05:09.000Z" itemprop="datePublished">2017-09-09</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Log/">Log</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/">Nodejs</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React/">React</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sass/">Sass</a><span class="category-list-count">2</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/asynchronous/" style="font-size: 10px;">asynchronous</a> <a href="/tags/closure/" style="font-size: 10px;">closure</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/ejs/" style="font-size: 10px;">ejs</a> <a href="/tags/express/" style="font-size: 10px;">express</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/idempotent/" style="font-size: 10px;">idempotent</a> <a href="/tags/middleware/" style="font-size: 10px;">middleware</a> <a href="/tags/nesting/" style="font-size: 10px;">nesting</a> <a href="/tags/nvm/" style="font-size: 10px;">nvm</a> <a href="/tags/object/" style="font-size: 10px;">object</a> <a href="/tags/prototype/" style="font-size: 10px;">prototype</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/sass-syntax/" style="font-size: 10px;">sass syntax</a> <a href="/tags/semantic-ui-react/" style="font-size: 10px;">semantic-ui-react</a> <a href="/tags/session/" style="font-size: 10px;">session</a> <a href="/tags/urlshortner/" style="font-size: 10px;">urlshortner</a> <a href="/tags/webform/" style="font-size: 10px;">webform</a>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="https://huusz.github.io/" class="logo" style="font-size: 32px">Huusz's Log</a>
                </h1>
                <p>&copy; 2017 huusz</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'huuszLog';
    
    
    var disqus_url = 'http://huusz.github.io/2017/Nodejs/nodejs/09.session/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
