<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=yes"><title>테스트 하지 않던 코드 테스트 하기 | huusz</title><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/nayo.min.css"></head><body><header class="header"><nav class="header-nav"><span class="iconfont icon-menu mobile-toggle"></span><div class="header-menu"><a class="header-menu-link" id="header-menu-home" href="/">Home</a> <a class="header-menu-link" id="header-menu-archives" href="/archives">Archives</a> <a class="header-menu-link" id="header-menu-tags" href="/tags">Tags</a> <a class="header-menu-link" id="header-menu-about" href="/about">About</a> <a class="iconfont icon-menu-search header-menu-link" id="header-menu-search"></a></div></nav></header><div class="container"><section class="main"><article class="post"><div class="post-header"><p class="post-title">테스트 하지 않던 코드 테스트 하기</p><div class="meta-info"><span>Jul 02, 2018 </span><i class="iconfont icon-words"></i> <span>11890</span></div></div><div class="post-content slideDownMin"><h1 id="TDD-맛-테스트-연습하기"><a href="#TDD-맛-테스트-연습하기" class="headerlink" title="TDD 맛 테스트 연습하기"></a>TDD 맛 테스트 연습하기</h1><p>내가 테스트 코드를 작성하기 시작한 것은 불과 2달 전이다. 그 전까지는 테스트 코드를 작성하지 않았다. 해본 적이 없었고, 어떻게 시작하는 지 몰라서였다. 어디서 부터 시작 해야 할 지 모르겠는 그 막막함 때문에 항상 시도만 하다가 테스트 파일을 지워버리곤 했었다. 구글에서 검색해서 나오는 블로그 글이나 아티클들은 아주 간단한 함수들을 예제로 하고 있어서 실무 코드에 활용하기가 쉽지 않았다. 이 글에서는 내가 테스트 코드 작성을 어떻게 시작했는 지와 기존에 테스트 코드 없이 이미 작성한 코드로 어떻게 (미약하게 나마) TDD를 했는 지를 이야기 하려고 한다. 참고로 예제 코드는 React로 작성되었고, 테스트 프레임 워크로는 Jest를 사용하였다.</p><p><br></p><h2 id="1-함수로-추출하자"><a href="#1-함수로-추출하자" class="headerlink" title="1. 함수로 추출하자."></a>1. 함수로 추출하자.</h2><p>프로젝트의 전반적인 컴포넌트 구조는</p><ul><li><p>[부모] Redux와 API 요청 및 React 라이프 사이클 함수를 호출하는 Container 컴포넌트</p></li><li><p>[자식] 실제 View를 반환하는 순수 함수로 작성된 Presentational 컴포넌트</p></li></ul><p>이렇게 두 컴포넌트가 중심이 된다.</p><p>사이드 이펙트가 발생할 수 있는 모든 요소는 Container 컴포넌트에 있고, Presentational 컴포넌트는 최대한 순수하게 유지하고 있다. 그래서, Container 컴포넌트가 정말 길고 복잡하고, 가독성도 매우 떨어졌다. 내가 테스트를 위해 가장 먼저 한 일은 Container 컴포넌트에 숨어 있는 비즈니스 로직을 순수 함수로 추출하는 일이다. 비즈니스 로직은 DOM 조작이 필요하지 않기 때문에 순수 함수로 떼어낸다면 쉽게 테스트 할 수 있다. 어떤 식으로 함수를 추출할 수 있는지는, 먼저 아래 ‘테스트 없이 작성된 코드’ 예시를 보자. (이 코드는 예시만을 위한 것으로, 많은 부분이 생략되어 동작하지 않을 것이다.)</p><h3 id="1-발견"><a href="#1-발견" class="headerlink" title="1) 발견"></a>1) 발견</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RegisterFormContainer.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterFormContainer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleOpen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    UserActions.openModal();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClose = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    UserActions.closeModal();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSubmit = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ************* 함수로 추출할 부분은 바로 여기 이다!! *****************</span></span><br><span class="line">    <span class="keyword">const</span> &#123; validateValues &#125; = <span class="keyword">this</span>.props.form;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> command = &#123;</span><br><span class="line">      username: validateValues.username || validateValues.email,</span><br><span class="line">      email: validateValues.email,</span><br><span class="line">      tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// ************************************************************</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> postRegisterRequest(command);</span><br><span class="line">      <span class="keyword">this</span>.handleClose();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">      Modal.info(&#123;</span><br><span class="line">        message: <span class="string">'Register failed.'</span></span><br><span class="line">        icon: <span class="literal">true</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;Modal </span><br><span class="line">        visible=&#123;<span class="keyword">this</span>.props.visible&#125;</span><br><span class="line">        open=&#123;<span class="keyword">this</span>.handleOpen&#125;</span><br><span class="line">        close=&#123;<span class="keyword">this</span>.handleClose&#125;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;RegisterForm submit=&#123;<span class="keyword">this</span>.handleSubmit&#125;/&gt;</span><br><span class="line">      &lt;<span class="regexp">/Modal&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125; </span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default connect((&#123;user&#125;) =&gt; (&#123;</span></span><br><span class="line"><span class="regexp">  form: &#123;</span></span><br><span class="line"><span class="regexp">    validateValues: user.form.validateValues,</span></span><br><span class="line"><span class="regexp">    visible: user.form.isModalVisible,</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;))(RegisterFormContainer)</span></span><br></pre></td></tr></table></figure><h2 id="2-추출"><a href="#2-추출" class="headerlink" title="2) 추출"></a>2) 추출</h2><p>processRegisterCommand 라는 이름의 함수를 외부 파일로 생성하고, 일단 발견한 부분을 무작정 추출해온다.<br>당연히 코드는 정상적으로 돌아가지 않을 것이다. 아무것도 수정하지 않는다. 다만, 어떤 것을 리턴할 것인지만 정한다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; validateValues &#125; = <span class="keyword">this</span>.props.form;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> command = &#123;</span><br><span class="line">    username: validateValues.username || validateValues.email,</span><br><span class="line">    email: validateValues.email,</span><br><span class="line">    tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">    date: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> command;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>아까의 RegisterFormContainer 컴포넌트에서 새로 만든 함수를 불러와서 적용한다.</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RegisterFormContainer.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterFormContainer</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// (생략)</span></span><br><span class="line"></span><br><span class="line">  handleSubmit = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// ************* 함수로 추출한 부분이다!! *****************</span></span><br><span class="line">    <span class="keyword">const</span> command = processRegisterCommand();</span><br><span class="line">    <span class="comment">// ***************************************************</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> postRegisterRequest(command);</span><br><span class="line">      <span class="keyword">this</span>.handleClose();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">      Modal.info(&#123;</span><br><span class="line">        message: <span class="string">'Register failed.'</span></span><br><span class="line">        icon: <span class="literal">true</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// (생략)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><br></p><h2 id="2-함수가-하는-일을-테스트-수트로-작성한다"><a href="#2-함수가-하는-일을-테스트-수트로-작성한다" class="headerlink" title="2. 함수가 하는 일을 테스트 수트로 작성한다."></a>2. 함수가 하는 일을 테스트 수트로 작성한다.</h2><p>이제 테스트 파일을 만든다. 그리고 아까 추출한 processRegisterCommand 함수를 불러온다. 테스트 수트는 describe 구문으로 작성할 수 있다. describe 구문에는 함수가 하는 일을, test 구문에는 그 일을 마치기 위해 필요한 단계들 혹은 확인해야 할 것들을 잘게 쪼갠다.</p><p>유의할 점은, 처음부터 모든 시나리오를 빠짐없이 적으려 해서는 안 된다는 것이다. 오래 생각하지 않아도 바로 바로 눈에 띄는 것들 위주로 일단 작성하는 게 중요하다. 테스트를 처음 해보는 입장에서는 본격적으로 테스트 코드를 작성 해보기도 전에 힘이 빠져 버린다. 부족한 부분은 나중에 더 추가하면 그만이다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; validateValues &#125; = <span class="keyword">this</span>.props.form;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> command = &#123;</span><br><span class="line">    username: validateValues.username || validateValues.email,</span><br><span class="line">    email: validateValues.email,</span><br><span class="line">    tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">    date: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> command;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.test.js</span></span><br><span class="line"><span class="keyword">import</span> processRegisterCommand <span class="keyword">from</span> <span class="string">'../processRegisterCommand'</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'유효성 검사를 통과한 값들을 command 데이터 포맷으로 정제하여 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 예외를 발생시키지 않는다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하지 않으면, 예외를 발생시킨다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 command 객체를 반환한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 username 속성이 존재하지 않으면, email 속성으로 대체한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 tel 속성이 존재하지 않으면, null로 대체한다.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>사실 이렇게 여러 테스트 케이스를 미리 작성하지 않아도 된다. 하나씩 차례 차례 해 나가도 전혀 상관 없다. 다만, 이렇게 하고 나면 내가 추출한 함수가 어떤 일을 하고 그 일을 위해 어떤 것을 체크해야 하는 지가 한 눈에 보인다.</p><p><br></p><h2 id="3-TDD-맛-테스트-코드를-작성해보자"><a href="#3-TDD-맛-테스트-코드를-작성해보자" class="headerlink" title="3. TDD 맛 테스트 코드를 작성해보자!"></a>3. TDD 맛 테스트 코드를 작성해보자!</h2><h3 id="1-Red-실패하는-테스트-코드-작성"><a href="#1-Red-실패하는-테스트-코드-작성" class="headerlink" title="1) Red - 실패하는 테스트 코드 작성"></a>1) Red - 실패하는 테스트 코드 작성</h3><p>일단 처음에는 누가봐도 무조건 실패할 것 같은 구문부터 시작한다. 아래 테스트 코드는 실패할 수 밖에 없다. 애초에 함수 자체가 현재 오류 상태이기 때문이다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.test.js</span></span><br><span class="line"><span class="keyword">import</span> processRegisterCommand <span class="keyword">from</span> <span class="string">'../processRegisterCommand'</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'유효성 검사를 통과한 값들을 command 데이터 포맷으로 정제하여 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ***************************** 첫번째 테스트 코드 *************************</span></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 예외를 발생시키지 않는다.'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> param = &#123;</span><br><span class="line">      username: <span class="string">'user'</span></span><br><span class="line">      email: <span class="string">'user@email.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>],</span><br><span class="line">    &#125;;</span><br><span class="line">    expect(<span class="function"><span class="params">()</span> =&gt;</span> processRegisterCommand(param)).not.toThrowError();</span><br><span class="line">  &#125;);</span><br><span class="line">   <span class="comment">// ********************************************************************</span></span><br><span class="line"></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하지 않으면, 예외를 발생시킨다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 command 객체를 반환한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 username 속성이 존재하지 않으면, email 속성으로 대체한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 tel 속성이 존재하지 않으면, null로 대체한다.'</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-Green-프로덕션-코드를-수정해서-테스트-성공시키기"><a href="#2-Green-프로덕션-코드를-수정해서-테스트-성공시키기" class="headerlink" title="2) Green - 프로덕션 코드를 수정해서 테스트 성공시키기"></a>2) Green - 프로덕션 코드를 수정해서 테스트 성공시키기</h3><p>이제 테스트가 성공하도록 processRegisterCommand 함수를 수정해주면 된다. 오류가 생기는 부분은 분명 ‘this.props’ 일 것이다. 이 구문 자체가 리액트에 의존적인 코드이기 때문이다. 지금 함수는 리액트와 아무 상관 없는 일반 자바스크립트 함수이다. 그러니 this.props.form.validateValues 가 아니라, validateValues 값 자체를 파라미터로 받는다. 그러면 오류를 반환하지 않게 되므로, 테스트에 통과할 것이다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">validateValues</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// const &#123; validateValues &#125; = this.props.form; &lt;- 이 부분을 지우고, 파라미터로 받는다.</span></span><br><span class="line">  <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> command = &#123;</span><br><span class="line">    username: validateValues.username || validateValues.email,</span><br><span class="line">    email: validateValues.email,</span><br><span class="line">    tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">    date: <span class="keyword">new</span> <span class="built_in">Date</span>(),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> command;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>두번째 테스트 코드를 작성해보자.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.test.js</span></span><br><span class="line"><span class="keyword">import</span> processRegisterCommand <span class="keyword">from</span> <span class="string">'../processRegisterCommand'</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'유효성 검사를 통과한 값들을 command 데이터 포맷으로 정제하여 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ***************************** 두번째 테스트 코드 *************************</span></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하지 않으면, 예외를 발생시킨다.'</span>, () =&gt; &#123;</span><br><span class="line">    expect(<span class="function"><span class="params">()</span> =&gt;</span> processRegisterCommand(<span class="literal">undefined</span>)).toThrowError();</span><br><span class="line">  &#125;);</span><br><span class="line">   <span class="comment">// ********************************************************************</span></span><br><span class="line"></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 command 객체를 반환한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 username 속성이 존재하지 않으면, email 속성으로 대체한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 tel 속성이 존재하지 않으면, null로 대체한다.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>이 코드는 성공할 것이다. 프로덕션 코드에 이미 에러 처리 구문이 포함되어 있기 때문이다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">validateValues</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">    <span class="comment">// validateValues가 undefined이면 에러를 던진다.</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> command = &#123;</span><br><span class="line">    username: validateValues.username || validateValues.email,</span><br><span class="line">    email: validateValues.email,</span><br><span class="line">    tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">    date: <span class="keyword">new</span> <span class="built_in">Date</span>(), </span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> command;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>이미 작성된 코드에 테스트를 추가하는 일은 TDD처럼 항상 테스트 실패(Red) 단계로 시작할 수 없다. 이미 작성된 코드를 기반으로 테스트 시나리오를 만들기 때문에 이처럼 작성과 동시에 성공하는 테스트 위주로 만들어지게 된다. 앞에서 작성한 나머지 테스트들도 로직에 큰 문제가 없다면 대부분 성공할 것이다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.test.js</span></span><br><span class="line"><span class="keyword">import</span> processRegisterCommand <span class="keyword">from</span> <span class="string">'../processRegisterCommand'</span>;</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'유효성 검사를 통과한 값들을 command 데이터 포맷으로 정제하여 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ***************************** 세번째 테스트 코드 *************************</span></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 command 객체를 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> param = &#123;</span><br><span class="line">      username: <span class="string">'user'</span></span><br><span class="line">      email: <span class="string">'user@email.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>],</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> command = &#123;</span><br><span class="line">      username: <span class="string">'user'</span>,</span><br><span class="line">      email: <span class="string">'user@email.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="comment">// 이 부분 때문에 이 함수는 아직 순수 함수가 아니다. 나중에 리팩터 할 것이다.</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> actual = processRegisterCommand(param);</span><br><span class="line">    expect(actual).toEqual(command);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// ********************************************************************</span></span><br><span class="line"></span><br><span class="line">  test(<span class="string">'validateValues의 username 속성이 존재하지 않으면, email 속성으로 대체한다.'</span>);</span><br><span class="line">  test(<span class="string">'validateValues의 tel 속성이 존재하지 않으면, null로 대체한다.'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="3-Refactor-테스트가-실패하지-않는-범위-내에서-코드-개선하기"><a href="#3-Refactor-테스트가-실패하지-않는-범위-내에서-코드-개선하기" class="headerlink" title="3) Refactor - 테스트가 실패하지 않는 범위 내에서 코드 개선하기"></a>3) Refactor - 테스트가 실패하지 않는 범위 내에서 코드 개선하기</h3><p>위에서 command 객체의 date 속성에 <code>new Date()</code> 값이 들어간다. 이 부분 때문에 processRegisterCommand 함수는 순수 함수가 아니다. 순수 함수는 input이 같으면 output도 항상 같아야 한다. 그런데 이 함수는 2018년 7월 2일에 실행하면 date 속성이 2018-07-02인 command 객체를 반환하고, 2018년 7월 3일에 실행하면 date 속성이 2018-07-03인 command 객체를 반환한다. 즉 input이 동일함에도, 함수를 실행하는 시점에 따라 output이 바뀐다. 이를 순수 함수로 만들어주는 리팩터링을 이 단계에서 시도할 수 있다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">validateValues, date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!validateValues) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> command = &#123;</span><br><span class="line">    username: validateValues.username || validateValues.email,</span><br><span class="line">    email: validateValues.email,</span><br><span class="line">    tel: validateValues.tel || <span class="literal">null</span>,</span><br><span class="line">    date, <span class="comment">// date: date, 와 같다.</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> command;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>date를 파라미터로 받도록 리팩터 하였다. 이렇게 하면 비로소 processRegisterCommand 함수는 순수 함수가 된다. 앞서 수정해 준 것과 동일하게 테스트 코드도 약간 수정해준다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.test.js</span></span><br><span class="line"><span class="keyword">import</span> processRegisterCommand <span class="keyword">from</span> <span class="string">'../processRegisterCommand'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"> <span class="comment">// ***************************** 세번째 테스트 코드 *************************</span></span><br><span class="line">  test(<span class="string">'validateValues 파라미터가 존재하면 command 객체를 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> param = &#123;</span><br><span class="line">      username: <span class="string">'user'</span></span><br><span class="line">      email: <span class="string">'user@email.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>],</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> command = &#123;</span><br><span class="line">      username: <span class="string">'user'</span>,</span><br><span class="line">      email: <span class="string">'user@email.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      date, </span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> actual = processRegisterCommand(param, date);</span><br><span class="line">    expect(actual).toEqual(command);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// ********************************************************************</span></span><br></pre></td></tr></table></figure><p>단계는 여기서 끝이다! 이제 위 Red ~ Refactor까지를 반복하면 된다. 다만 앞서 말했듯 이미 작성된 코드에 테스트 코드를 추가하는 것이므로 Red 단계를 못 볼 가능성이 높다. 이제 나머지 테스트 코드들도 작성해보자.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// ***************************** 나머지 테스트 코드 *************************</span></span><br><span class="line">  test(<span class="string">'validateValues의 username 속성이 존재하지 않으면, email 속성으로 대체한다.'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> param = &#123;</span><br><span class="line">      username: <span class="literal">undefined</span>,</span><br><span class="line">      email: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>],</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> command = &#123;</span><br><span class="line">      username: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">      email: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">      tel: <span class="string">'01012345678'</span>,</span><br><span class="line">      date,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> actual = processRegisterCommand(param, date);</span><br><span class="line">    expect(actual).toEqual(command);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  test(<span class="string">'validateValues의 tel 속성이 존재하지 않으면, null로 대체한다.'</span>, () =&gt; &#123;</span><br><span class="line">     <span class="keyword">const</span> param = &#123;</span><br><span class="line">      username: <span class="string">'user'</span>,</span><br><span class="line">      email: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">      tel: <span class="literal">undefined</span>,</span><br><span class="line">      agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>],</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> command = &#123;</span><br><span class="line">      username: <span class="string">'user'</span>,</span><br><span class="line">      email: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">      tel: <span class="literal">null</span>,</span><br><span class="line">      date,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> actual = processRegisterCommand(param, date);</span><br><span class="line">    expect(actual).toEqual(command);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>모든 테스트 코드가 성공하는 것을 확인했으니, 간단한 리팩터링을 시도한다.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">source, date</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 1. validateValues 파라미터 명을 source로 변경해주었다.</span></span><br><span class="line">  <span class="keyword">if</span>(!source) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. command 변수를 굳이 선언하지 않고, 곧바로 리턴해주었다.</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    username: source.username || source.email,</span><br><span class="line">    email: source.email,</span><br><span class="line">    tel: source.tel || <span class="literal">null</span>,</span><br><span class="line">    date,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>이렇게 하면 한결 깔끔해진 함수와 함께, 첫 번째 테스트 코드가 완성된다.</p><h2 id="4-스펙을-추가하자-선택"><a href="#4-스펙을-추가하자-선택" class="headerlink" title="++ 4. 스펙을 추가하자! (선택)"></a>++ 4. 스펙을 추가하자! (선택)</h2><p>테스트 코드 작성 중 추가적으로 필요한 스펙이 떠오른다거나, 새로운 비즈니스 요구 사항에 의해 기능을 추가해야 하는 상황이 올 수 있다. 이렇게 기존에 없던 새로운 로직이 들어가야 할 때가 바로 TDD를 연습해볼 수 있는 기회이다.</p><p>만약 param 파라미터의 agreement 배열이 모두 true가 아니면 null을 반환하는 스펙을 추가한다고 해보자.</p><ol><li>먼저 테스트 코드부터 작성한다.</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">test(<span class="string">'agreement가 하나라도 false이면 null을 반환한다.'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> param = &#123;</span><br><span class="line">    username: <span class="string">'user'</span>,</span><br><span class="line">    email: <span class="string">'user@gamil.com'</span>,</span><br><span class="line">    tel: <span class="literal">undefined</span>,</span><br><span class="line">    agreement: [<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> actual = processRegisterCommand(param, date);</span><br><span class="line">  expect(actual).toBeNull();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>당연히 실패하는 테스트이다. (Red 단계)</p><ol start="2"><li>프로덕션 코드를 수정한다.</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// processRegisterCommand.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">source, date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!source) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ************************ 추가된 부분 ************************</span></span><br><span class="line">  <span class="comment">// source의 agreement 속성에 false가 포함되어 있으면, null을 리턴한다.</span></span><br><span class="line">  <span class="keyword">if</span> (source.agreement.some(<span class="function"><span class="params">agree</span> =&gt;</span> !agree)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ********************************************************</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    username: source.username || source.email,</span><br><span class="line">    email: source.email,</span><br><span class="line">    tel: source.tel || <span class="literal">null</span>,</span><br><span class="line">    date,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>테스트가 성공하게끔, 프로덕션 코드를 수정해준다. (Green 단계).</p><ol start="3"><li>리팩터링 한다.</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasFalse</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array.some(<span class="function"><span class="params">agree</span> =&gt;</span> !agree);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">processRegisterCommand</span>(<span class="params">source, date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!source) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; username, email, tel = <span class="literal">null</span>, agreement &#125; = source;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> hasFalse(agreement)</span><br><span class="line">    ? <span class="literal">null</span></span><br><span class="line">    : &#123;</span><br><span class="line">        username: username || email,</span><br><span class="line">        email,</span><br><span class="line">        tel,</span><br><span class="line">        date,</span><br><span class="line">      &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이 글을 통해 말하고자 했던 바는 TDD가 아니고 (나도 아직 아주 아주 허접이니까), 너무 어렵게 생각하지 말고 아주 작은 부분 부터 하나씩 뜯어서 테스트 해보자는 것이다. 작은 것 부터 하나씩 연습하다보면 뭐 부터, 어떻게 시작해야 할 지 모르겠는 그 막막함을 조금 덜어낼 수 있다. 계속 연습하다보면 어느 정도 테스트가 손에 익고, 어떻게 해야 할 지 약간 감이 오기 시작한다. 그 때 TDD도 연습해보고, 더 다양한 테스팅 툴도 사용해 보면 된다. 조급하게 생각하지 말자! 경력 30년 된 우리 회사 CTO님이 테스트 코드 만 개는 작성해 봐야 한다고 했다!</p></div><div class="post-meta"><i class="iconfont icon-category"></i> <a class="category-link" href="/categories/Test/">Test</a> <i class="iconfont icon-tag"></i> <a class="tag-link" href="/tags/Jest/">Jest</a> <a class="tag-link" href="/tags/React-test/">React test</a> <a class="tag-link" href="/tags/Unit-test/">Unit test</a></div><div class="post-footer"><div class="pf-left"><img class="pf-avatar" src="/images/header.png"><p class="pf-des">hi</p></div><div class="pf-right"><div class="pf-links"><script id="-mob-share" src="http://f1.webshare.mob.com/code/mob-share.js?appkey=21d601593a1de"></script><span class="share-btn"><span class="iconfont icon-share"></span></span><div class="-mob-share sildeUpMin"><a class="iconfont icon-share-facebook -mob-share-facebook"></a> <a class="iconfont icon-share-google -mob-share-google"></a></div></div><nav class="pf-paginator"><a href="/2018/멍청/멍청1/" data-hover="Enzyme - Cannot read property &#39;have&#39; of undefined">Next</a></nav></div></div><div id="disqus_thread"></div><script>!function(){var t=document,e=t.createElement("script");e.src="https://huusz.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></article></section></div><a id="backTop"><span><i class="iconfont icon-backtotop"></i></span></a><div class="search-container sildeUpMin"><div class="search-header"><input type="text" placeholder="Typing Something here." id="search-input" class="search-input"> <span class="search-cancel iconfont icon-cancel"></span></div><div id="search-result" class="search-result"></div></div><div class="mobile-menu"><img class="mobile-menu-icon" src="/images/favicon.png"> <a class="mobile-menu-link" href="/">Home </a><a class="mobile-menu-link" href="/archives">Archives </a><a class="mobile-menu-link" href="/tags">Tags </a><a class="mobile-menu-link" href="/about">About </a><a class="mobile-menu-link mobile-menu-search" href="#">Search</a></div><footer id="footer"><div class="footer-copyright">&copy; 2018 huusz<br>Theme By <a href="https://github.com/Lemonreds/hexo-theme-Nayo" target="_blank">Nayo</a></div></footer><script src="/nayo.bundle.js"></script></body></html>